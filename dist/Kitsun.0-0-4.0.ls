import PluginBase from 'chrome-extension://lnnmjmalakahagblkkcnjkoaihlfglon/dist/modules/plugin-base.js';import ExtensionUtil from 'chrome-extension://lnnmjmalakahagblkkcnjkoaihlfglon/dist/modules/extension-util.js';function E(){let u=document.getElementById("typeans");if(u===null)return!1;let e=u.getAttribute("placeholder");return e===null?!1:!!(e==="Enter Prefecture Name ..."||e.match(/Click on the.*Prefecture!/))}function k(u){let e=B[u];return e==null?u:e.toLowerCase()}var B={とうほく:"Tohoku",かんさい:"Kansai",かんとう:"Kanto",ちゅうぶ:"Chubu",ちゅうごく:"Chugoku",しこく:"Shikoku",きゅうしゅう:"Kyushu",あいち:"Aichi",あきた:"Akita",あおもり:"Aomori",ちば:"Chiba",えひめ:"Ehime",ふくい:"Fukui",ふくおか:"Fukuoka",ふくしま:"Fukushima",ぎふ:"Gifu",ぐんま:"Gunma",ひろしま:"Hiroshima",ほっかいどう:"Hokkaido",ひょうご:"Hyogo",いばらき:"Ibaraki",いしかわ:"Ishikawa",いわて:"Iwate",かがわ:"Kagawa",かごしま:"Kagoshima",かながわ:"Kanagawa",こうち:"Kochi",くまもと:"Kumamoto",きょうと:"Kyoto",みえ:"Mie",みやぎ:"Miyagi",みやざき:"Miyazaki",ながの:"Nagano",ながさき:"Nagasaki",なら:"Nara",にいがた:"Niigata",おおいた:"Oita",おかやま:"Okayama",おきなわ:"Okinawa",おおさか:"Osaka",さが:"Saga",さいたま:"Saitama",しが:"Shiga",しまね:"Shimane",しずおか:"Shizuoka",とちぎ:"Tochigi",とくしま:"Tokushima",とうきょう:"Tokyo",とっとり:"Tottori",とやま:"Toyama",わかやま:"Wakayama",やまがた:"Yamagata",やまぐち:"Yamaguchi",やまなし:"Yamanashi",愛知:"Aichi",秋田:"Akita",青森:"Aomori",千葉:"Chiba",愛媛:"Ehime",福井:"Fukui",福岡:"Fukuoka",福島:"Fukushima",岐阜:"Gifu",群馬:"Gunma",広島:"Hiroshima",北海道:"Hokkaido",兵庫:"Hyogo",茨城:"Ibaraki",石川:"Ishikawa",岩手:"Iwate",香川:"Kagawa",鹿児島:"Kagoshima",神奈川:"Kanagawa",高知:"Kochi",熊本:"Kumamoto",京都:"Kyoto",三重:"Mie",宮城:"Miyagi",宮崎:"Miyazaki",長野:"Nagano",長崎:"Nagasaki",奈良:"Nara",新潟:"Niigata",大分:"Oita",岡山:"Okayama",沖縄:"Okinawa",大阪:"Osaka",佐賀:"Saga",埼玉:"Saitama",滋賀:"Shiga",島根:"Shimane",静岡:"Shizuoka",栃木:"Tochigi",徳島:"Tokushima",東京:"Tokyo",鳥取:"Tottori",富山:"Toyama",和歌山:"Wakayama",山形:"Yamagata",山口:"Yamaguchi",山梨:"Yamanashi"},h=/^https:\/\/kitsun\.io\/deck\/.*\/(reviews|lessons|selfstudy)$/,s={Flipping:"Flipping",Flipped:"Flipped"},r,c,g,l;function y(u){let e="゠".codePointAt(0),t="ヿ".codePointAt(0),a="ア".codePointAt(0)-"あ".codePointAt(0);return u.split("").map(n=>{let i=n.codePointAt(0);return n==="ー"?n:i>=e&&i<=t?String.fromCodePoint(i-a):n}).join("")}function v(u){return u.replace(/[!"#$%&'()*+,-./:;<=>?@\[\\\]^_`{|}~"]/," ")}function d(u){let e=[],n=u.replace(/[\u200B-\u200D\uFEFF]/g,"").replace(/\(.*\)/,"").split(",").map(o=>o.trim().toLowerCase()).filter(o=>o.length!=0);for(var i=0;i<n.length;i++){let o=n[i];e.push(o),v(o)!==o&&e.push(o)}return e}function C(){var u=[];let e=document.getElementById("typeans");if(e!==null){let a=e.getAttribute("answer");a!==null&&(u=u.concat(d(a)))}let t=document.getElementById("combinedans");if(t!==null){let a=t.innerHTML;a!==null&&(u=u.concat(d(a)))}return u}function K(){let e=PluginBase.util.getLanguage()==="en-US"?"wrong":"あああ",t=document.getElementById("typeans");t!==null&&(t.value=e,f())}function b(){let u=C();u.length>0&&(l=u[0],m({preTs:"",normTs:u[0]}))}function D(u,e){return u===e||e.replace(new RegExp(u,"g"),"").length===0}function m({preTs:u,normTs:e}){let t=C(),a=e.toLowerCase();console.log("[Kitsun.matchAnswer] t=%s, a=%o",a,t);for(var n=0;n<t.length;n++){let i=y(t[n]),o=PluginBase.util.getLanguage()==="ja"&&t[n].match(/[a-zA-Z]+/)&&i===k(a);if(D(i,a)||o)return console.log("[Kitsun.matchAnswer] a=%s h=%s t=%s",t[n],i,a),l=t[n],[0,a.length,[t[n]]]}l=""}function f(){let u=document.querySelectorAll("body > div.swal2-container.swal2-center.swal2-fade.swal2-shown > div > div.swal2-buttonswrapper > button.swal2-confirm.swal2-styled");if(u.length>0){u.item(0).click();return}let e=document.getElementById("nextans"),t=document.querySelectorAll(".kitButton.flip_btn.kitButton__primary");e!==null?e.click():t.length>0?t.item(0).click():console.log("[Kitsun.clickNext] failed to find next button")}function x({preTs:u,normTs:e}){if(l.length<1){console.log("[Kitsun.inputAnswer] matched transcript but matchedAnswer=%s? transcript=%s",l,e);return}let t=document.getElementById("typeans");t!==null?(t.value=l,f()):console.log("[Kitsun.inputAnswer] typeans was null")}function L(){let u=document.getElementsByClassName("quest");for(var e=!1,t=0;t<u.length;t++){let n=u[t].innerHTML.trim();if(n==="Vocabulary Meaning")return"en";if(n==="Vocabulary Reading")return"ja"}return null}function S(){let u=document.getElementById("typeans");if(u===null)return null;let e=u.getAttribute("placeholder");if(e==="English"||e==="Meaning")return"en";if(e==="Japanese"||e==="Reading")return"ja";{let t=u.getAttribute("lang");return t===null||t!=="ja"&&t!=="en"?null:t}}function P(){if(E())return console.log("[Kitsun.setLanguage] set to Japanese for prefectures deck"),PluginBase.util.setLanguage("ja"),!0;var u=S();return u!==null?(console.log("[Kitsun.setLanguage] set to %s based on typeans (10k/user deck)",u),PluginBase.util.setLanguage(u),!0):(u=L(),u!==null?(console.log("[Kitsun.setLanguage] set to %s based on quest (10k)",u),PluginBase.util.setLanguage(u),!0):(console.log("[Kitsun.setLanguage] failed to set language!"),!1))}function w(u,e){console.log("[Kitsun.mutationCallback] "+s[r]),r===s.Flipping&&document.location.href.match(h)&&P()&&(r=s.Flipped)}function F(){console.log("[Kitsun.exitKitsunContext]"),PluginBase.util.enterContext(["Normal"]),c!==null&&PluginBase.util.setLanguage(c),g!==null&&g.disconnect()}function T(){console.log("[Kitsun.enterKitsunContext]"),r=s.Flipping,PluginBase.util.enterContext(["Kitsun Review"]),c=PluginBase.util.getLanguage();let u={attributes:!0,childList:!0,subtree:!0};g=new MutationObserver(w);let e=document.getElementsByClassName("main-container")[0];g.observe(e,u),w(null,null)}function p(){document.location.href.match(h)?T():PluginBase.util.getContext().includes("Kitsun Review")&&F()}var A={...PluginBase,languages:{},niceName:"Kitsun",description:"",match:/^https:\/\/kitsun\.io\/.*$/,apiVersion:2,version:"0.0.4",init:()=>{r=s.Flipping,c=PluginBase.util.getLanguage();let u=`history.pushState = ( f => function pushState(){
            var ret = f.apply(this, arguments);
            window.dispatchEvent(new Event('locationchange'));
            return ret;
        })(history.pushState);
        history.replaceState = ( f => function replaceState(){
            var ret = f.apply(this, arguments);
            window.dispatchEvent(new Event('locationchange'));
            return ret;
        })(history.replaceState);`;var e=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.innerHTML=u,e.appendChild(t),window.addEventListener("locationchange",p),p()},destroy:()=>{window.removeEventListener("locationchange",p),F()},contexts:{"Kitsun Review":{commands:["Change Language to Japanese","LipSurf.Normal Mode","LipSurf.Turn off LipSurf","Answer","Next","Correct","Wrong"]}},commands:[{name:"Answer",description:"Submit an English answer for a Kitsun review",match:{description:"[English answer]",fn:m},context:"Kitsun Review",normal:!1,pageFn:x},{name:"Next",description:"Go to the next item in a Kitsun review",match:"next",context:"Kitsun Review",normal:!1,pageFn:()=>{r=s.Flipping,f()}},{name:"Wrong",description:"Mark a card wrong",match:"wrong",context:"Kitsun Review",normal:!1,pageFn:K},{name:"Correct",description:"Mark a card correct",match:"correct",context:"Kitsun Review",normal:!1,pageFn:b}]};A.languages.ja={niceName:"Kitsun",description:"Kitsun",commands:{Answer:{name:"答え (answer)",match:{description:"[Kitsunの答え]",fn:m}},Next:{name:"次へ (next)",match:["つぎ","ねくすと","ていしゅつ","すすむ","ちぇっく"]},Wrong:{name:"バツ (wrong)",match:["だめ","ばつ"]},Correct:{name:"正しい (correct)",match:["ただしい"]}}};var M=A;export{M as default};
LS-SPLITallPlugins.Kitsun=(()=>{function k(){let u=document.getElementById("typeans");if(u===null)return!1;let e=u.getAttribute("placeholder");return e===null?!1:!!(e==="Enter Prefecture Name ..."||e.match(/Click on the.*Prefecture!/))}function f(u){let e=v[u];return e==null?u:e.toLowerCase()}var v={とうほく:"Tohoku",かんさい:"Kansai",かんとう:"Kanto",ちゅうぶ:"Chubu",ちゅうごく:"Chugoku",しこく:"Shikoku",きゅうしゅう:"Kyushu",あいち:"Aichi",あきた:"Akita",あおもり:"Aomori",ちば:"Chiba",えひめ:"Ehime",ふくい:"Fukui",ふくおか:"Fukuoka",ふくしま:"Fukushima",ぎふ:"Gifu",ぐんま:"Gunma",ひろしま:"Hiroshima",ほっかいどう:"Hokkaido",ひょうご:"Hyogo",いばらき:"Ibaraki",いしかわ:"Ishikawa",いわて:"Iwate",かがわ:"Kagawa",かごしま:"Kagoshima",かながわ:"Kanagawa",こうち:"Kochi",くまもと:"Kumamoto",きょうと:"Kyoto",みえ:"Mie",みやぎ:"Miyagi",みやざき:"Miyazaki",ながの:"Nagano",ながさき:"Nagasaki",なら:"Nara",にいがた:"Niigata",おおいた:"Oita",おかやま:"Okayama",おきなわ:"Okinawa",おおさか:"Osaka",さが:"Saga",さいたま:"Saitama",しが:"Shiga",しまね:"Shimane",しずおか:"Shizuoka",とちぎ:"Tochigi",とくしま:"Tokushima",とうきょう:"Tokyo",とっとり:"Tottori",とやま:"Toyama",わかやま:"Wakayama",やまがた:"Yamagata",やまぐち:"Yamaguchi",やまなし:"Yamanashi",愛知:"Aichi",秋田:"Akita",青森:"Aomori",千葉:"Chiba",愛媛:"Ehime",福井:"Fukui",福岡:"Fukuoka",福島:"Fukushima",岐阜:"Gifu",群馬:"Gunma",広島:"Hiroshima",北海道:"Hokkaido",兵庫:"Hyogo",茨城:"Ibaraki",石川:"Ishikawa",岩手:"Iwate",香川:"Kagawa",鹿児島:"Kagoshima",神奈川:"Kanagawa",高知:"Kochi",熊本:"Kumamoto",京都:"Kyoto",三重:"Mie",宮城:"Miyagi",宮崎:"Miyazaki",長野:"Nagano",長崎:"Nagasaki",奈良:"Nara",新潟:"Niigata",大分:"Oita",岡山:"Okayama",沖縄:"Okinawa",大阪:"Osaka",佐賀:"Saga",埼玉:"Saitama",滋賀:"Shiga",島根:"Shimane",静岡:"Shizuoka",栃木:"Tochigi",徳島:"Tokushima",東京:"Tokyo",鳥取:"Tottori",富山:"Toyama",和歌山:"Wakayama",山形:"Yamagata",山口:"Yamaguchi",山梨:"Yamanashi"},F=/^https:\/\/kitsun\.io\/deck\/.*\/(reviews|lessons|selfstudy)$/,i={Flipping:"Flipping",Flipped:"Flipped"},l,m,h,r;function d(u){let e="゠".codePointAt(0),t="ヿ".codePointAt(0),n="ア".codePointAt(0)-"あ".codePointAt(0);return u.split("").map(a=>{let s=a.codePointAt(0);return a==="ー"?a:s>=e&&s<=t?String.fromCodePoint(s-n):a}).join("")}function K(u){return u.replace(/[!"#$%&'()*+,-./:;<=>?@\[\\\]^_`{|}~"]/," ")}function E(u){let e=[],a=u.replace(/[\u200B-\u200D\uFEFF]/g,"").replace(/\(.*\)/,"").split(",").map(o=>o.trim().toLowerCase()).filter(o=>o.length!=0);for(var s=0;s<a.length;s++){let o=a[s];e.push(o),K(o)!==o&&e.push(o)}return e}function c(){var u=[];let e=document.getElementById("typeans");if(e!==null){let n=e.getAttribute("answer");n!==null&&(u=u.concat(E(n)))}let t=document.getElementById("combinedans");if(t!==null){let n=t.innerHTML;n!==null&&(u=u.concat(E(n)))}return u}function T(){let e=PluginBase.util.getLanguage()==="en-US"?"wrong":"あああ",t=document.getElementById("typeans");t!==null&&(t.value=e,g())}function S(){let u=c();u.length>0&&(r=u[0],A({preTs:"",normTs:u[0]}))}function w(u,e){return u===e||e.replace(new RegExp(u,"g"),"").length===0}function A({preTs:u,normTs:e}){let t=c(),n=e.toLowerCase();console.log("[Kitsun.matchAnswer] t=%s, a=%o",n,t);for(var a=0;a<t.length;a++){let s=d(t[a]),o=PluginBase.util.getLanguage()==="ja"&&t[a].match(/[a-zA-Z]+/)&&s===f(n);if(w(s,n)||o)return console.log("[Kitsun.matchAnswer] a=%s h=%s t=%s",t[a],s,n),r=t[a],[0,n.length,[t[a]]]}r=""}function g(){let u=document.querySelectorAll("body > div.swal2-container.swal2-center.swal2-fade.swal2-shown > div > div.swal2-buttonswrapper > button.swal2-confirm.swal2-styled");if(u.length>0){u.item(0).click();return}let e=document.getElementById("nextans"),t=document.querySelectorAll(".kitButton.flip_btn.kitButton__primary");e!==null?e.click():t.length>0?t.item(0).click():console.log("[Kitsun.clickNext] failed to find next button")}function x({preTs:u,normTs:e}){if(r.length<1){console.log("[Kitsun.inputAnswer] matched transcript but matchedAnswer=%s? transcript=%s",r,e);return}let t=document.getElementById("typeans");t!==null?(t.value=r,g()):console.log("[Kitsun.inputAnswer] typeans was null")}function b(){let u=document.getElementsByClassName("quest");for(var e=!1,t=0;t<u.length;t++){let a=u[t].innerHTML.trim();if(a==="Vocabulary Meaning")return"en";if(a==="Vocabulary Reading")return"ja"}return null}function D(){let u=document.getElementById("typeans");if(u===null)return null;let e=u.getAttribute("placeholder");if(e==="English"||e==="Meaning")return"en";if(e==="Japanese"||e==="Reading")return"ja";{let t=u.getAttribute("lang");return t===null||t!=="ja"&&t!=="en"?null:t}}function L(){if(k())return console.log("[Kitsun.setLanguage] set to Japanese for prefectures deck"),PluginBase.util.setLanguage("ja"),!0;var u=D();return u!==null?(console.log("[Kitsun.setLanguage] set to %s based on typeans (10k/user deck)",u),PluginBase.util.setLanguage(u),!0):(u=b(),u!==null?(console.log("[Kitsun.setLanguage] set to %s based on quest (10k)",u),PluginBase.util.setLanguage(u),!0):(console.log("[Kitsun.setLanguage] failed to set language!"),!1))}function y(u,e){console.log("[Kitsun.mutationCallback] "+i[l]),l===i.Flipping&&document.location.href.match(F)&&L()&&(l=i.Flipped)}function B(){console.log("[Kitsun.exitKitsunContext]"),PluginBase.util.enterContext(["Normal"]),m!==null&&PluginBase.util.setLanguage(m),h!==null&&h.disconnect()}function P(){console.log("[Kitsun.enterKitsunContext]"),l=i.Flipping,PluginBase.util.enterContext(["Kitsun Review"]),m=PluginBase.util.getLanguage();let u={attributes:!0,childList:!0,subtree:!0};h=new MutationObserver(y);let e=document.getElementsByClassName("main-container")[0];h.observe(e,u),y(null,null)}function C(){document.location.href.match(F)?P():PluginBase.util.getContext().includes("Kitsun Review")&&B()}return{...PluginBase,init:()=>{l=i.Flipping,m=PluginBase.util.getLanguage();let u=`history.pushState = ( f => function pushState(){
            var ret = f.apply(this, arguments);
            window.dispatchEvent(new Event('locationchange'));
            return ret;
        })(history.pushState);
        history.replaceState = ( f => function replaceState(){
            var ret = f.apply(this, arguments);
            window.dispatchEvent(new Event('locationchange'));
            return ret;
        })(history.replaceState);`;var e=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.innerHTML=u,e.appendChild(t),window.addEventListener("locationchange",C),C()},destroy:()=>{window.removeEventListener("locationchange",C),B()},commands:{Answer:{match:{en:function({preTs:e,normTs:t}){let n=c(),a=t.toLowerCase();console.log("[Kitsun.matchAnswer] t=%s, a=%o",a,n);for(var s=0;s<n.length;s++){let o=d(n[s]),p=PluginBase.util.getLanguage()==="ja"&&n[s].match(/[a-zA-Z]+/)&&o===f(a);if(w(o,a)||p)return console.log("[Kitsun.matchAnswer] a=%s h=%s t=%s",n[s],o,a),r=n[s],[0,a.length,[n[s]]]}r=""},ja:function({preTs:e,normTs:t}){let n=c(),a=t.toLowerCase();console.log("[Kitsun.matchAnswer] t=%s, a=%o",a,n);for(var s=0;s<n.length;s++){let o=d(n[s]),p=PluginBase.util.getLanguage()==="ja"&&n[s].match(/[a-zA-Z]+/)&&o===f(a);if(w(o,a)||p)return console.log("[Kitsun.matchAnswer] a=%s h=%s t=%s",n[s],o,a),r=n[s],[0,a.length,[n[s]]]}r=""}},pageFn:function({preTs:e,normTs:t}){if(r.length<1){console.log("[Kitsun.inputAnswer] matched transcript but matchedAnswer=%s? transcript=%s",r,t);return}let n=document.getElementById("typeans");n!==null?(n.value=r,g()):console.log("[Kitsun.inputAnswer] typeans was null")}},Next:{pageFn:()=>{l=i.Flipping,g()}},Wrong:{pageFn:function(){let t=PluginBase.util.getLanguage()==="en-US"?"wrong":"あああ",n=document.getElementById("typeans");n!==null&&(n.value=t,g())}},Correct:{pageFn:function(){let e=c();e.length>0&&(r=e[0],A({preTs:"",normTs:e[0]}))}}}}})();
LS-SPLITallPlugins.Kitsun=(()=>{function E(){let u=document.getElementById("typeans");if(u===null)return!1;let e=u.getAttribute("placeholder");return e===null?!1:!!(e==="Enter Prefecture Name ..."||e.match(/Click on the.*Prefecture!/))}function k(u){let e=w[u];return e==null?u:e.toLowerCase()}var w={とうほく:"Tohoku",かんさい:"Kansai",かんとう:"Kanto",ちゅうぶ:"Chubu",ちゅうごく:"Chugoku",しこく:"Shikoku",きゅうしゅう:"Kyushu",あいち:"Aichi",あきた:"Akita",あおもり:"Aomori",ちば:"Chiba",えひめ:"Ehime",ふくい:"Fukui",ふくおか:"Fukuoka",ふくしま:"Fukushima",ぎふ:"Gifu",ぐんま:"Gunma",ひろしま:"Hiroshima",ほっかいどう:"Hokkaido",ひょうご:"Hyogo",いばらき:"Ibaraki",いしかわ:"Ishikawa",いわて:"Iwate",かがわ:"Kagawa",かごしま:"Kagoshima",かながわ:"Kanagawa",こうち:"Kochi",くまもと:"Kumamoto",きょうと:"Kyoto",みえ:"Mie",みやぎ:"Miyagi",みやざき:"Miyazaki",ながの:"Nagano",ながさき:"Nagasaki",なら:"Nara",にいがた:"Niigata",おおいた:"Oita",おかやま:"Okayama",おきなわ:"Okinawa",おおさか:"Osaka",さが:"Saga",さいたま:"Saitama",しが:"Shiga",しまね:"Shimane",しずおか:"Shizuoka",とちぎ:"Tochigi",とくしま:"Tokushima",とうきょう:"Tokyo",とっとり:"Tottori",とやま:"Toyama",わかやま:"Wakayama",やまがた:"Yamagata",やまぐち:"Yamaguchi",やまなし:"Yamanashi",愛知:"Aichi",秋田:"Akita",青森:"Aomori",千葉:"Chiba",愛媛:"Ehime",福井:"Fukui",福岡:"Fukuoka",福島:"Fukushima",岐阜:"Gifu",群馬:"Gunma",広島:"Hiroshima",北海道:"Hokkaido",兵庫:"Hyogo",茨城:"Ibaraki",石川:"Ishikawa",岩手:"Iwate",香川:"Kagawa",鹿児島:"Kagoshima",神奈川:"Kanagawa",高知:"Kochi",熊本:"Kumamoto",京都:"Kyoto",三重:"Mie",宮城:"Miyagi",宮崎:"Miyazaki",長野:"Nagano",長崎:"Nagasaki",奈良:"Nara",新潟:"Niigata",大分:"Oita",岡山:"Okayama",沖縄:"Okinawa",大阪:"Osaka",佐賀:"Saga",埼玉:"Saitama",滋賀:"Shiga",島根:"Shimane",静岡:"Shizuoka",栃木:"Tochigi",徳島:"Tokushima",東京:"Tokyo",鳥取:"Tottori",富山:"Toyama",和歌山:"Wakayama",山形:"Yamagata",山口:"Yamaguchi",山梨:"Yamanashi"},f=/^https:\/\/kitsun\.io\/deck\/.*\/(reviews|lessons|selfstudy)$/,r={Flipping:"Flipping",Flipped:"Flipped"},l,c,g,s;function B(u){let e="゠".codePointAt(0),t="ヿ".codePointAt(0),a="ア".codePointAt(0)-"あ".codePointAt(0);return u.split("").map(n=>{let i=n.codePointAt(0);return n==="ー"?n:i>=e&&i<=t?String.fromCodePoint(i-a):n}).join("")}function y(u){return u.replace(/[!"#$%&'()*+,-./:;<=>?@\[\\\]^_`{|}~"]/," ")}function h(u){let e=[],n=u.replace(/[\u200B-\u200D\uFEFF]/g,"").replace(/\(.*\)/,"").split(",").map(o=>o.trim().toLowerCase()).filter(o=>o.length!=0);for(var i=0;i<n.length;i++){let o=n[i];e.push(o),y(o)!==o&&e.push(o)}return e}function p(){var u=[];let e=document.getElementById("typeans");if(e!==null){let a=e.getAttribute("answer");a!==null&&(u=u.concat(h(a)))}let t=document.getElementById("combinedans");if(t!==null){let a=t.innerHTML;a!==null&&(u=u.concat(h(a)))}return u}function L(){let e=PluginBase.util.getLanguage()==="en-US"?"wrong":"あああ",t=document.getElementById("typeans");t!==null&&(t.value=e,C())}function S(){let u=p();u.length>0&&(s=u[0],d({preTs:"",normTs:u[0]}))}function v(u,e){return u===e||e.replace(new RegExp(u,"g"),"").length===0}function d({preTs:u,normTs:e}){let t=p(),a=e.toLowerCase();console.log("[Kitsun.matchAnswer] t=%s, a=%o",a,t);for(var n=0;n<t.length;n++){let i=B(t[n]),o=PluginBase.util.getLanguage()==="ja"&&t[n].match(/[a-zA-Z]+/)&&i===k(a);if(v(i,a)||o)return console.log("[Kitsun.matchAnswer] a=%s h=%s t=%s",t[n],i,a),s=t[n],[0,a.length,[t[n]]]}s=""}function C(){let u=document.querySelectorAll("body > div.swal2-container.swal2-center.swal2-fade.swal2-shown > div > div.swal2-buttonswrapper > button.swal2-confirm.swal2-styled");if(u.length>0){u.item(0).click();return}let e=document.getElementById("nextans"),t=document.querySelectorAll(".kitButton.flip_btn.kitButton__primary");e!==null?e.click():t.length>0?t.item(0).click():console.log("[Kitsun.clickNext] failed to find next button")}function T({preTs:u,normTs:e}){if(s.length<1){console.log("[Kitsun.inputAnswer] matched transcript but matchedAnswer=%s? transcript=%s",s,e);return}let t=document.getElementById("typeans");t!==null?(t.value=s,C()):console.log("[Kitsun.inputAnswer] typeans was null")}function K(){let u=document.getElementsByClassName("quest");for(var e=!1,t=0;t<u.length;t++){let n=u[t].innerHTML.trim();if(n==="Vocabulary Meaning")return"en";if(n==="Vocabulary Reading")return"ja"}return null}function b(){let u=document.getElementById("typeans");if(u===null)return null;let e=u.getAttribute("placeholder");if(e==="English"||e==="Meaning")return"en";if(e==="Japanese"||e==="Reading")return"ja";{let t=u.getAttribute("lang");return t===null||t!=="ja"&&t!=="en"?null:t}}function D(){if(E())return console.log("[Kitsun.setLanguage] set to Japanese for prefectures deck"),PluginBase.util.setLanguage("ja"),!0;var u=b();return u!==null?(console.log("[Kitsun.setLanguage] set to %s based on typeans (10k/user deck)",u),PluginBase.util.setLanguage(u),!0):(u=K(),u!==null?(console.log("[Kitsun.setLanguage] set to %s based on quest (10k)",u),PluginBase.util.setLanguage(u),!0):(console.log("[Kitsun.setLanguage] failed to set language!"),!1))}function F(u,e){console.log("[Kitsun.mutationCallback] "+r[l]),l===r.Flipping&&document.location.href.match(f)&&D()&&(l=r.Flipped)}function A(){console.log("[Kitsun.exitKitsunContext]"),PluginBase.util.enterContext(["Normal"]),c!==null&&PluginBase.util.setLanguage(c),g!==null&&g.disconnect()}function P(){console.log("[Kitsun.enterKitsunContext]"),l=r.Flipping,PluginBase.util.enterContext(["Kitsun Review"]),c=PluginBase.util.getLanguage();let u={attributes:!0,childList:!0,subtree:!0};g=new MutationObserver(F);let e=document.getElementsByClassName("main-container")[0];g.observe(e,u),F(null,null)}function m(){document.location.href.match(f)?P():PluginBase.util.getContext().includes("Kitsun Review")&&A()}return{...PluginBase,init:()=>{l=r.Flipping,c=PluginBase.util.getLanguage();let u=`history.pushState = ( f => function pushState(){
            var ret = f.apply(this, arguments);
            window.dispatchEvent(new Event('locationchange'));
            return ret;
        })(history.pushState);
        history.replaceState = ( f => function replaceState(){
            var ret = f.apply(this, arguments);
            window.dispatchEvent(new Event('locationchange'));
            return ret;
        })(history.replaceState);`;var e=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.innerHTML=u,e.appendChild(t),window.addEventListener("locationchange",m),m()},destroy:()=>{window.removeEventListener("locationchange",m),A()},commands:{}}})();
