import PluginBase from 'chrome-extension://lnnmjmalakahagblkkcnjkoaihlfglon/dist/modules/plugin-base.js';import ExtensionUtil from 'chrome-extension://lnnmjmalakahagblkkcnjkoaihlfglon/dist/modules/extension-util.js';var matchedAnswer="",previousLanguage=PluginBase.util.getLanguage();const particles={"もう":"も","わ":"は"};function fuzzyParticle(transcript){const maybe=particles[transcript];return null===maybe?transcript:maybe}function isParticle(child){return child instanceof HTMLSpanElement&&child.classList.contains("chui")}function getText(component){return answer=component,Array.from(answer.childNodes).filter(child=>"RUBY"===child.tagName).length>0?function(answer){return Array.from(answer.childNodes).map(child=>child instanceof Text?child.data:"RUBY"===child.tagName?Array.from(child.querySelectorAll("rt")).map(rt=>rt.innerText).join(""):void 0).join("")}(component):component.innerText;var answer;}function getCandidateAnswers(sentence){let candidates=[],candidate=null,components=Array.from(sentence.childNodes);for(let i=0;i<components.length;i++){const component=components[i];"STRONG"===component.tagName||isParticle(component)?(null===candidate&&(candidate=""),candidate+=getText(component)):(null!==candidate&&candidates.push(candidate),candidate=null);}return candidates}function getAnswers(){let promptStrongs=Array.from(document.querySelectorAll("div.study-question-japanese strong")).map(strong=>strong.innerHTML),sentences=Array.from(document.querySelectorAll(".examples .japanese-example-sentence")),candidates=(arr=sentences,f=getCandidateAnswers,[].concat.apply([],arr.map(f)));var arr,f;candidates=candidates.filter(candidate=>!promptStrongs.includes(candidate));let counts=new Map;return candidates.forEach(candidate=>{let value=counts.get(candidate);void 0===value?counts.set(candidate,1):counts.set(candidate,value+1);}),Array.from(counts.keys())}function matchAnswer(transcript){transcript=transcript.toLowerCase();const answers=getAnswers();for(var i=0;i<answers.length;i++){const hiragana=answers[i];if(hiragana===transcript||hiragana===fuzzyParticle(transcript))return answers[i],matchedAnswer=answers[i],[0,transcript.length,[answers[i]]]}matchedAnswer="";}function inputAnswer(transcript){if(matchedAnswer.length<1)return;const studyAreaInput=document.getElementById("study-answer-input");null!==studyAreaInput&&(studyAreaInput.value=matchedAnswer,clickNext());}function clickElement(selector){const element=document.querySelector(selector);null!==element&&element.click();}function clickNext(){clickElement("#submit-study-answer");}function exitBunproContext(){PluginBase.util.enterContext(["Normal"]),PluginBase.util.setLanguage(previousLanguage);}function locationChangeHandler(){document.location.href,document.location.href.match(/.*bunpro.jp\/(learn|study|cram)$/)?(previousLanguage=PluginBase.util.getLanguage(),PluginBase.util.enterContext(["Bunpro"]),PluginBase.util.setLanguage("ja")):exitBunproContext();}var Bunpro={...PluginBase,niceName:"Bunpro",languages:{},description:"",match:/.*bunpro.jp.*/,version:"0.0.2",init:()=>{var head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.type="text/javascript",script.innerHTML="history.pushState = ( f => function pushState(){\n        var ret = f.apply(this, arguments);\n        window.dispatchEvent(new Event('locationchange'));\n        return ret;\n    })(history.pushState);\n    history.replaceState = ( f => function replaceState(){\n        var ret = f.apply(this, arguments);\n        window.dispatchEvent(new Event('locationchange'));\n        return ret;\n    })(history.replaceState);",head.appendChild(script),window.addEventListener("locationchange",locationChangeHandler),locationChangeHandler();},destroy:()=>{window.removeEventListener("locationchange",locationChangeHandler),exitBunproContext();},contexts:{Bunpro:{commands:["LipSurf.Change Language to Japanese","LipSurf.Normal Mode","LipSurf.Turn off LipSurf","Answer","Hint","Next","Wrong","Info"]}},commands:[{name:"Answer",description:"Submit an answer for a Bunpro review",match:{description:"[answer]",fn:transcript=>{if(document.location.href.match(/.*www.bunpro.jp\/(learn|study|cram)$/))return matchAnswer(transcript)}},normal:!1,pageFn:inputAnswer},{name:"Hint",description:"Toggle the translated hint",match:"hint",normal:!1,pageFn:function(){clickElement("#show-english-hint");}},{name:"Next",description:"Go to the next card",match:"next",normal:!1,pageFn:clickNext},{name:"Wrong",description:"Mark a card wrong",match:"wrong",normal:!1,pageFn:function(){matchedAnswer="あああ",inputAnswer();}},{name:"Info",description:"Show grammar info",match:"info",normal:!1,pageFn:function(){clickElement("#show-grammar");}}]};Bunpro.languages.ja={niceName:"Bunpro",description:"Bunpro",commands:{Answer:{name:"答え (answer)",match:{description:"[Bunproの答え]",fn:matchAnswer}},Hint:{name:"暗示 (hint)",match:["ひんと","あんじ"]},Next:{name:"次へ (next)",match:["つぎ","ねくすと","ていしゅつ","すすむ","ちぇっく"]},Wrong:{name:"バツ (wrong)",match:["だめ","ばつ"]},Info:{name:"情報 (info)",match:["じょうほう"]}}};

export default Bunpro;
export { matchAnswer };LS-SPLITallPlugins.Bunpro = (() => { var matchedAnswer="",previousLanguage=PluginBase.util.getLanguage();const particles={"もう":"も","わ":"は"};function fuzzyParticle(transcript){const maybe=particles[transcript];return null===maybe?transcript:maybe}function isParticle(child){return child instanceof HTMLSpanElement&&child.classList.contains("chui")}function getText(component){return answer=component,Array.from(answer.childNodes).filter(child=>"RUBY"===child.tagName).length>0?function(answer){return Array.from(answer.childNodes).map(child=>child instanceof Text?child.data:"RUBY"===child.tagName?Array.from(child.querySelectorAll("rt")).map(rt=>rt.innerText).join(""):void 0).join("")}(component):component.innerText;var answer;}function getCandidateAnswers(sentence){let candidates=[],candidate=null,components=Array.from(sentence.childNodes);for(let i=0;i<components.length;i++){const component=components[i];"STRONG"===component.tagName||isParticle(component)?(null===candidate&&(candidate=""),candidate+=getText(component)):(null!==candidate&&candidates.push(candidate),candidate=null);}return candidates}function getAnswers(){let promptStrongs=Array.from(document.querySelectorAll("div.study-question-japanese strong")).map(strong=>strong.innerHTML),sentences=Array.from(document.querySelectorAll(".examples .japanese-example-sentence")),candidates=(arr=sentences,f=getCandidateAnswers,[].concat.apply([],arr.map(f)));var arr,f;candidates=candidates.filter(candidate=>!promptStrongs.includes(candidate));let counts=new Map;return candidates.forEach(candidate=>{let value=counts.get(candidate);void 0===value?counts.set(candidate,1):counts.set(candidate,value+1);}),Array.from(counts.keys())}function matchAnswer(transcript){transcript=transcript.toLowerCase();const answers=getAnswers();for(var i=0;i<answers.length;i++){const hiragana=answers[i];if(hiragana===transcript||hiragana===fuzzyParticle(transcript))return answers[i],matchedAnswer=answers[i],[0,transcript.length,[answers[i]]]}matchedAnswer="";}function inputAnswer(transcript){if(matchedAnswer.length<1)return;const studyAreaInput=document.getElementById("study-answer-input");null!==studyAreaInput&&(studyAreaInput.value=matchedAnswer,clickNext());}function clickElement(selector){const element=document.querySelector(selector);null!==element&&element.click();}function clickNext(){clickElement("#submit-study-answer");}function exitBunproContext(){PluginBase.util.enterContext(["Normal"]),PluginBase.util.setLanguage(previousLanguage);}function locationChangeHandler(){document.location.href,document.location.href.match(/.*bunpro.jp\/(learn|study|cram)$/)?(previousLanguage=PluginBase.util.getLanguage(),PluginBase.util.enterContext(["Bunpro"]),PluginBase.util.setLanguage("ja")):exitBunproContext();}var Bunpro={...PluginBase,init:()=>{var head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.type="text/javascript",script.innerHTML="history.pushState = ( f => function pushState(){\n        var ret = f.apply(this, arguments);\n        window.dispatchEvent(new Event('locationchange'));\n        return ret;\n    })(history.pushState);\n    history.replaceState = ( f => function replaceState(){\n        var ret = f.apply(this, arguments);\n        window.dispatchEvent(new Event('locationchange'));\n        return ret;\n    })(history.replaceState);",head.appendChild(script),window.addEventListener("locationchange",locationChangeHandler),locationChangeHandler();},destroy:()=>{window.removeEventListener("locationchange",locationChangeHandler),exitBunproContext();},commands:{Answer:{match:{en:transcript=>{if(document.location.href.match(/.*www.bunpro.jp\/(learn|study|cram)$/))return matchAnswer(transcript)},ja:matchAnswer},normal:!1,pageFn:inputAnswer},Hint:{normal:!1,pageFn:function(){clickElement("#show-english-hint");}},Next:{normal:!1,pageFn:clickNext},Wrong:{normal:!1,pageFn:function(){matchedAnswer="あああ",inputAnswer();}},Info:{normal:!1,pageFn:function(){clickElement("#show-grammar");}}}};

return Bunpro;
 })()LS-SPLITallPlugins.Bunpro = (() => { var previousLanguage=PluginBase.util.getLanguage();function exitBunproContext(){PluginBase.util.enterContext(["Normal"]),PluginBase.util.setLanguage(previousLanguage);}function locationChangeHandler(){document.location.href,document.location.href.match(/.*bunpro.jp\/(learn|study|cram)$/)?(previousLanguage=PluginBase.util.getLanguage(),PluginBase.util.enterContext(["Bunpro"]),PluginBase.util.setLanguage("ja")):exitBunproContext();}var Bunpro={...PluginBase,init:()=>{var head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.type="text/javascript",script.innerHTML="history.pushState = ( f => function pushState(){\n        var ret = f.apply(this, arguments);\n        window.dispatchEvent(new Event('locationchange'));\n        return ret;\n    })(history.pushState);\n    history.replaceState = ( f => function replaceState(){\n        var ret = f.apply(this, arguments);\n        window.dispatchEvent(new Event('locationchange'));\n        return ret;\n    })(history.replaceState);",head.appendChild(script),window.addEventListener("locationchange",locationChangeHandler),locationChangeHandler();},destroy:()=>{window.removeEventListener("locationchange",locationChangeHandler),exitBunproContext();},commands:{}};

return Bunpro;
 })()